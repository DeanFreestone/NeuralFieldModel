% Matlab Implementation of Neural Field Model
% tex file of implementation document


\documentclass[a4paper, 12pt, english]{article}


% packages
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}


% graphic path
\graphicspath{{/Users/miao/Documents/Miao/Neurosciences/Projects/NeuralFieldModel/Figures/}}


% title of this manuscript
\title{Matlab Implementation of Neural Field Model}
\author{Miao Cao}
\date{1 July 2016}


\begin{document}

% title of the document
\begin{titlepage}\centering
\vspace*{\fill}
\maketitle
\vspace*{\fill}
\end{titlepage}

\tableofcontents

\newpage



% Introduction
\section{Introduction}
\paragraph{In order to implement and simulate Neural Field Model in Matlab, we break down
neural field model into several parts based mathematical equations and independently implement and test each part. The
following sections show the details of our implementation. Please always refer to
Freestone et al., 2011, NeuroImage for derivations, equations and details.}

\newpage




% Convolution of two Gaussians
\section{Convolution of Two Gaussian Basis Functions}

\paragraph{Analytically prove convolution of two Gaussians. In general, the
precision level of analytic simulation should be around $10^{-6}$.}

\paragraph{File (Matlab script): Convolution2DGaussians.m}

\subsection*{Matlab script description}

Appendix E (Freestone et al., 2011, NeuroImage), Equation (4) $\left(\phi_{i}\otimes\phi_{j}\right)(r)=(\frac{\pi\sigma_{i}^{2}\sigma_{j}^{2}}{\sigma_{i}^{2}+\sigma_{i}^{2}})^{\frac{n}{2}}\exp(-\frac{1}{\sigma_{i}^{2}+\sigma_{i}^{2}}r^{T}r)$.

\subparagraph{Section: Generate spatial data, create a $NPoints\times NPoints$ cortical surface and phi and psi Gaussian basis functions.\\}


\subsection{Parameters}



\subsection{Implementations}



\subsection{Results}
\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{Convolution2DGaussians_Analytic_Conv2.pdf}
\caption{Residual(analytic, Conv2)}\label{Convolution2DGaussians_Analytic_Conv2.pdf}
\end{figure}



\newpage




% Compute Gamma
\section{Compute Gamma}

\paragraph{File (Matlab script): ComputeGamma.m}

\subsection*{Matlab script description}

\paragraph{This matlab script mainly implement and estimate the following two
equations, (21) and Appendix (D.7) (Freestone et al. 2011 NeuroImage).}

\paragraph{Field, v(r), is decomposed of a finite-dimensional state vector and
a vector of Gaussian basis functions.}

\paragraph{Define $\Gamma=\int_{\Omega}\phi(r)\phi^{T}(r)dr$. Firstly, programmatically
define $\phi(r)$, as a vector of Gaussian basis functions. Each Gaussian
function is defined as $\phi(r-r')=\exp{(-\frac{(r-r')^{T}(r-r')}{\sigma_{\phi}^{2}})}$.}


\subsection{Parameter List}
\subsection{Implementations}
\subsection{Results}

\newpage



% Compute Psi
\section{Compute Psi}
\paragraph{We implement to compute Psi.}


\subsection{Parameter List}
\subsection{Implementations}
\subsection{Results}

\newpage


\section{Compute State Vector at time T+1}
\label{state vector}
\paragraph{parameter table, figures}
\subsection{Parameter List}
\subsection{Implementations}
\subsection{Results}
\newpage





\section{Compute Reduced Model}
\subsection{Parameter List}
\subsection{Implementations}
\subsection{Results}

\newpage





\section{Compute Full Model}
\paragraph{We numerically compute neural field at time T+1 based on field at time T.
As opposed to reduced model, full model does not decompose neural field into field basis functions; it directly convolves
the neural field at time T with connectivity kernel.}

\subparagraph{In the full model, when we convolve neural field at time T with connectivity kernel,
we have significant errors or residual on the edges of the field. In order to conquer this,
we apply a boundary condition method to extend the field into 9 tiles and each tile is an identical copy
of the neural field.}

\subsection{Parameters}
\subsection{Implementations}
\subsection{Results}
\newpage


\section{Compare Reduced Model and Full Model}
\paragraph{Compare neural fields at time T+1 computed by reduced model and full model.\newline
Script name: Compare\_CompleteModel\_ReducedModel.m}
\subsection{Parameters}
\subsection{Implementations}
\subsection{Results}


\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{modelComparison_MexHat_nx_121_sigma_1_5_nPoints_501_vTPlus1.pdf}
\caption{Connectivity kernel, Mexican Hat}
\end{figure}


\end{document}
